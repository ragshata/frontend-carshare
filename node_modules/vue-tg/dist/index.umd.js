(function(r,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r["vue-tg"]={},r.Vue))})(this,function(r,t){"use strict";const h=t.defineComponent({__name:"Alert",props:{message:{type:String,required:!0}},emits:["close"],setup(e,{emit:a}){const n=e,o=a,{showAlert:i}=f();return t.onMounted(()=>i(n.message,()=>o("close"))),(s,c)=>null}}),W=t.defineComponent({__name:"BackButton",props:{visible:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:a}){const n=e,o=a,{showBackButton:i,onBackButtonClicked:s,hideBackButton:c}=L();return t.watch(()=>n.visible,p=>{p?i():c()}),s(()=>o("click")),t.onMounted(()=>n.visible&&i()),t.onUnmounted(()=>c()),(p,d)=>null}}),T=t.defineComponent({__name:"BiometricManager",emits:["init"],setup(e,{emit:a}){const n=a,{initBiometric:o}=G();return t.onMounted(()=>o(()=>n("init"))),(i,s)=>null}}),C=t.defineComponent({__name:"ClosingConfirmation",setup(e){const{enableClosingConfirmation:a,disableClosingConfirmation:n}=ee();return t.onMounted(()=>a()),t.onUnmounted(()=>n()),(o,i)=>null}}),S=t.defineComponent({__name:"Confirm",props:{message:{type:String,required:!0}},emits:["close"],setup(e,{emit:a}){const n=e,o=a,{showConfirm:i}=f();return t.onMounted(()=>i(n.message,s=>o("close",s))),(s,c)=>null}}),y=t.defineComponent({__name:"ExpandedViewport",props:{force:{type:Boolean,default:!1}},setup(e){const a=e,{isFeatureSupported:n}=u(),{onViewportChanged:o,expand:i,isExpanded:s,isVerticalSwipesEnabled:c}=De();return n("DisableVerticalSwipes")?t.watch(()=>a.force,p=>{p&&!s.value&&i(),c.value=!p},{immediate:!0}):o(({isStateStable:p})=>{a.force&&p&&!s.value&&i()}),t.onMounted(()=>i()),(p,d)=>null}}),k=t.defineComponent({__name:"MainButton",props:{text:{type:String},color:{type:String},textColor:{type:String},visible:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},progress:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:a}){const n=e,o=a,{setMainButtonParams:i,onMainButtonClicked:s,hideMainButton:c,showMainButtonProgress:p,hideMainButtonProgress:d}=ge();return t.watch(()=>n.text,l=>{i({text:l})}),t.watch(()=>n.color,l=>{i({color:l})}),t.watch(()=>n.textColor,l=>{i({text_color:l})}),t.watch(()=>n.visible,l=>{i({is_visible:l})}),t.watch(()=>n.disabled,l=>{i({is_active:!l})}),t.watch(()=>n.progress,l=>{l?p():d()}),s(()=>o("click")),t.onMounted(()=>{n.progress?p():d(),i({text:n.text,text_color:n.textColor,color:n.color,is_active:!n.disabled,is_visible:n.visible})}),t.onUnmounted(()=>{d(),c()}),(l,Et)=>null}}),w=t.defineComponent({__name:"Popup",props:{title:{type:String},message:{type:String,required:!0},buttons:{type:Array}},emits:["close"],setup(e,{emit:a}){const n=e,o=a,{showPopup:i}=f();return t.onMounted(()=>i({title:n.title,message:n.message,buttons:n.buttons},s=>o("close",s))),(s,c)=>null}}),M=t.defineComponent({__name:"ScanQr",props:{text:{type:String}},emits:["result"],setup(e,{emit:a}){const n=e,o=a,{showScanQrPopup:i,closeScanQrPopup:s}=fe();return t.onMounted(()=>i({text:n.text},c=>o("result",c))),t.onUnmounted(()=>s()),(c,p)=>null}}),P=t.defineComponent({__name:"SettingsButton",props:{visible:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:a}){const n=e,o=a,{showSettingsButton:i,onSettingsButtonClicked:s,hideSettingsButton:c}=We();return t.watch(()=>n.visible,p=>{p?i():c()}),s(()=>o("click")),t.onMounted(()=>n.visible&&i()),t.onUnmounted(()=>c()),(p,d)=>null}}),_=t.defineComponent({__name:"ShareWidget",props:{url:{type:String,required:!0},comment:{type:String,default:null},size:{type:String,default:null},noLabel:{type:Boolean,default:!1},tag:{type:String,default:"div"}},setup(e){const a=e,n=t.computed(()=>JSON.stringify(a));return(o,i)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tag),{key:n.value},{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("script"),{async:"",src:"https://telegram.org/js/telegram-widget.js?22","data-telegram-share-url":e.url,"data-size":e.size,"data-comment":e.comment,"data-text":e.noLabel?"notext":null},null,8,["data-telegram-share-url","data-size","data-comment","data-text"]))]),_:1}))}}),x=t.defineComponent({__name:"PostWidget",props:{url:{type:String,required:!0},width:{type:String,default:null},authorPhoto:{type:Boolean,default:null},color:{type:String,default:null},darkColor:{type:String,default:null},dark:{type:Boolean,default:null},tag:{type:String,default:"div"}},setup(e){const a=e,n=t.computed(()=>JSON.stringify(a));return(o,i)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tag),{key:n.value},{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("script"),{async:"",src:"https://telegram.org/js/telegram-widget.js?22","data-telegram-post":e.url,"data-width":e.width,"data-userpic":e.authorPhoto,"data-color":e.color,"data-dark-color":e.darkColor,"data-dark":e.dark},null,8,["data-telegram-post","data-width","data-userpic","data-color","data-dark-color","data-dark"]))]),_:1}))}}),q=t.defineComponent({__name:"LoginWidget",props:{botUsername:{type:String,required:!0},redirectUrl:{type:String,default:null},size:{type:String,default:null},cornerRadius:{type:String,default:null},userPhoto:{type:Boolean,default:null},requestWrite:{type:Boolean,default:!1},tag:{type:String,default:"div"}},emits:["auth"],setup(e,{emit:a}){const n=e,o=t.computed(()=>JSON.stringify(n)),i=a;return t.onMounted(()=>{window.onTelegramAuth=s=>i("auth",s)}),(s,c)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tag),{key:o.value},{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("script"),{async:"",src:"https://telegram.org/js/telegram-widget.js?22","data-telegram-login":e.botUsername,"data-size":e.size,"data-radius":e.cornerRadius,"data-userpic":e.userPhoto,"data-request-access":e.requestWrite?"write":null,"data-onauth":e.redirectUrl?null:"onTelegramAuth(user)","data-auth-url":e.redirectUrl},null,8,["data-telegram-login","data-size","data-radius","data-userpic","data-request-access","data-onauth","data-auth-url"]))]),_:1}))}}),E=t.defineComponent({__name:"DiscussionWidget",props:{url:{type:String,required:!0},commentsLimit:{type:Number,default:null},height:{type:String,default:null},color:{type:String,default:null},darkColor:{type:String,default:null},dark:{type:Boolean,default:null},colorful:{type:Boolean,default:null},tag:{type:String,default:"div"}},setup(e){const a=e,n=t.computed(()=>JSON.stringify(a));return(o,i)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tag),{key:n.value},{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("script"),{async:"",src:"https://telegram.org/js/telegram-widget.js?22","data-telegram-discussion":e.url,"data-comments-limit":e.commentsLimit,"data-height":e.height,"data-color":e.color,"data-dark-color":e.darkColor,"data-dark":e.dark,"data-colorful":e.colorful},null,8,["data-telegram-discussion","data-comments-limit","data-height","data-color","data-dark-color","data-dark","data-colorful"]))]),_:1}))}}),{initData:Re,initDataUnsafe:Ve,version:$e,platform:Ie,isVersionAtLeast:D,sendData:Ue,close:Qe}=Telegram.WebApp,R=t.ref(!1),He=(...e)=>{Telegram.WebApp.ready(...e),R.value=!0},V=e=>Telegram.WebApp.platform===e,$=V("unknown"),Le={ClosingConfirmation:"6.2",CloudStorage:"6.9",RequestWriteAccess:"6.9",RequestContact:"6.9",SettingsButton:"7.0",BiometricManager:"7.2",DisableVerticalSwipes:"7.7"},je=e=>D(Le[e]),ze=!$&&Telegram.WebApp.initData==="";function u(){return{initData:Re,initDataUnsafe:Ve,version:$e,platform:Ie,isVersionAtLeast:D,onEvent:(a,n,o={manual:!1})=>{const{manual:i}=o,s=()=>{Telegram.WebApp.onEvent(a,n)},c=()=>{Telegram.WebApp.offEvent(a,n)};return i?s():(t.onMounted(s),t.onUnmounted(c)),{off:c}},sendData:Ue,ready:He,close:Qe,isReady:t.readonly(R),isPlatform:V,isPlatformUnknown:$,isFeatureSupported:je,canSendData:ze}}const I=t.ref(Telegram.WebApp.BackButton.isVisible);function U(){I.value=Telegram.WebApp.BackButton.isVisible}function Q(...e){Telegram.WebApp.BackButton.show(...e),U()}function H(...e){Telegram.WebApp.BackButton.hide(...e),U()}function L(){const{onEvent:e}=u(),a=(n,o)=>e("backButtonClicked",n,o);return{isBackButtonVisible:t.computed({get(){return I.value},set(n){n?Q():H()}}),onBackButtonClicked:a,showBackButton:Q,hideBackButton:H}}const{init:Oe,requestAccess:Ne,authenticate:ve,updateBiometricToken:Je,openSettings:Fe}=Telegram.WebApp.BiometricManager,j=t.ref(Telegram.WebApp.BiometricManager.isInited),z=t.ref(Telegram.WebApp.BiometricManager.isBiometricAvailable),O=t.ref(Telegram.WebApp.BiometricManager.biometricType),N=t.ref(Telegram.WebApp.BiometricManager.isAccessRequested),v=t.ref(Telegram.WebApp.BiometricManager.isAccessGranted),J=t.ref(Telegram.WebApp.BiometricManager.isAccessGranted),F=t.ref(Telegram.WebApp.BiometricManager.deviceId);function Ge(){j.value=Telegram.WebApp.BiometricManager.isInited,z.value=Telegram.WebApp.BiometricManager.isBiometricAvailable,O.value=Telegram.WebApp.BiometricManager.biometricType,N.value=Telegram.WebApp.BiometricManager.isAccessRequested,v.value=Telegram.WebApp.BiometricManager.isAccessGranted,F.value=Telegram.WebApp.BiometricManager.deviceId,J.value=Telegram.WebApp.BiometricManager.isBiometricTokenSaved}function G(){const{onEvent:e}=u(),a=(i,s)=>e("biometricManagerUpdated",i,s),n=(i,s)=>e("biometricAuthRequested",i,s),o=(i,s)=>e("biometricTokenUpdated",i,s);return a(Ge),{isBiometricInited:t.readonly(j),isBiometricAvailable:t.readonly(z),biometricType:t.readonly(O),isBiometricAccessRequested:t.readonly(N),isBiometricAccessGranted:t.readonly(v),isBiometricTokenSaved:t.readonly(J),biometricDeviceId:t.readonly(F),initBiometric:Oe,requestBiometricAccess:Ne,authenticateBiometric:ve,updateBiometricToken:Je,openBiometricSettings:Fe,onBiometricManagerUpdated:a,onBiometricAuthRequested:n,onBiometricTokenUpdated:o}}const{readTextFromClipboard:Ke}=Telegram.WebApp;function Xe(){const{onEvent:e}=u();return{readTextFromClipboard:Ke,onClipboardTextReceived:(n,o)=>e("clipboardTextReceived",n,o)}}const K=t.ref(Telegram.WebApp.isClosingConfirmationEnabled);function X(){K.value=Telegram.WebApp.isClosingConfirmationEnabled}function Y(...e){Telegram.WebApp.enableClosingConfirmation(...e),X()}function Z(...e){Telegram.WebApp.disableClosingConfirmation(...e),X()}function ee(){return{isClosingConfirmationEnabled:t.computed({get(){return K.value},set(e){e?Y():Z()}}),enableClosingConfirmation:Y,disableClosingConfirmation:Z}}const g=Telegram.WebApp.CloudStorage;function Ye(e,a){return new Promise((n,o)=>{g.setItem(e,a,(i,s)=>{i&&o(i),n(s)})})}function Ze(e){return new Promise((a,n)=>{g.getItem(e,(o,i)=>{o&&n(o),a(i)})})}function et(e){return new Promise((a,n)=>{g.getItems(e,(o,i)=>{o&&n(o),a(i)})})}function tt(e){return new Promise((a,n)=>{g.removeItem(e,(o,i)=>{o&&n(o),a(i)})})}function nt(e){return new Promise((a,n)=>{g.removeItems(e,(o,i)=>{o&&n(o),a(i)})})}function ot(){return new Promise((e,a)=>{g.getKeys((n,o)=>{n&&a(n),e(o)})})}function at(){return{setStorageItem:Ye,getStorageItem:Ze,getStorageItems:et,removeStorageItem:tt,removeStorageItems:nt,getStorageKeys:ot}}const{impactOccurred:it,notificationOccurred:rt,selectionChanged:st}=Telegram.WebApp.HapticFeedback;function ct(){return{impactOccurred:it,notificationOccurred:rt,selectionChanged:st}}const te=t.ref(Telegram.WebApp.MainButton.text),ne=t.ref(Telegram.WebApp.MainButton.color),oe=t.ref(Telegram.WebApp.MainButton.textColor),ae=t.ref(Telegram.WebApp.MainButton.isVisible),ie=t.ref(Telegram.WebApp.MainButton.isActive),re=t.ref(Telegram.WebApp.MainButton.isProgressVisible);function m(){te.value=Telegram.WebApp.MainButton.text,ne.value=Telegram.WebApp.MainButton.color,oe.value=Telegram.WebApp.MainButton.textColor,ae.value=Telegram.WebApp.MainButton.isVisible,ie.value=Telegram.WebApp.MainButton.isActive,re.value=Telegram.WebApp.MainButton.isProgressVisible}function se(...e){Telegram.WebApp.MainButton.setText(...e),m()}function ce(...e){Telegram.WebApp.MainButton.show(...e),m()}function le(...e){Telegram.WebApp.MainButton.hide(...e),m()}function pe(...e){Telegram.WebApp.MainButton.enable(...e),m()}function ue(...e){Telegram.WebApp.MainButton.disable(...e),m()}function me(...e){Telegram.WebApp.MainButton.showProgress(...e),m()}function de(...e){Telegram.WebApp.MainButton.hideProgress(...e),m()}function B(...e){Telegram.WebApp.MainButton.setParams(...e),m()}function ge(){const{onEvent:e}=u(),a=(n,o)=>e("mainButtonClicked",n,o);return{mainButtonText:t.computed({get(){return te.value},set(n){se(n)}}),mainButtonColor:t.computed({get(){return ne.value},set(n){B({color:n})}}),mainButtonTextColor:t.computed({get(){return oe.value},set(n){B({text_color:n})}}),isMainButtonVisible:t.computed({get(){return ae.value},set(n){n?ce():le()}}),isMainButtonActive:t.computed({get(){return ie.value},set(n){n?pe():ue()}}),isMainButtonProgressVisible:t.computed({get(){return re.value},set(n){n?me():de()}}),setMainButtonText:se,onMainButtonClicked:a,showMainButton:ce,hideMainButton:le,enableMainButton:pe,disableMainButton:ue,showMainButtonProgress:me,hideMainButtonProgress:de,setMainButtonParams:B}}const{switchInlineQuery:lt,openLink:pt,openTelegramLink:ut,openInvoice:mt}=Telegram.WebApp;function dt(){const{onEvent:e}=u();return{switchInlineQuery:lt,openLink:pt,openTelegramLink:ut,openInvoice:mt,onInvoiceClosed:(n,o)=>e("invoiceClosed",n,o)}}const{showPopup:gt,showAlert:ft,showConfirm:bt}=Telegram.WebApp;function f(){const{onEvent:e}=u();return{showPopup:gt,showAlert:ft,showConfirm:bt,onPopupClosed:(n,o)=>e("popupClosed",n,o)}}const{showScanQrPopup:Bt,closeScanQrPopup:At}=Telegram.WebApp;function fe(){const{onEvent:e}=u();return{showScanQrPopup:Bt,closeScanQrPopup:At,onQrTextReceived:(o,i)=>e("qrTextReceived",o,i),onScanQrPopupClosed:(o,i)=>e("scanQrPopupClosed",o,i)}}const{requestContact:ht,requestWriteAccess:Wt}=Telegram.WebApp;function Tt(){const{onEvent:e}=u();return{requestContact:ht,onContactRequested:(o,i)=>e("contactRequested",o,i),requestWriteAccess:Wt,onWriteAccessRequested:(o,i)=>e("writeAccessRequested",o,i)}}const{initData:Ct,initDataUnsafe:St,sendData:yt,close:kt}=u();function wt(e,a){const n=a.serialize??JSON.stringify,o=t.ref(""),i=c=>{o.value=c,console.error(c)},s=t.ref(!1);return{error:o,isLoading:s,execute:()=>{yt(n(e)),setTimeout(()=>i("Telegram.WebApp.sendData is only available for custom keyboards."),1e3)},executeHttp:async(c,p={})=>{const d=p.closeAfter??!0;s.value=!0;try{const l=await fetch(c,{method:"POST",body:JSON.stringify({initData:Ct,initDataUnsafe:St,data:n(e)})});return l.ok||i(`${l.status} ${l.statusText}`),l.ok&&d&&kt(),l}catch(l){i(String(l))}finally{s.value=!1}}}}const be=t.ref(Telegram.WebApp.SettingsButton.isVisible);function Be(){be.value=Telegram.WebApp.SettingsButton.isVisible}function Ae(...e){Telegram.WebApp.SettingsButton.show(...e),Be()}function he(...e){Telegram.WebApp.SettingsButton.hide(...e),Be()}function We(){const{onEvent:e}=u(),a=(n,o)=>e("settingsButtonClicked",n,o);return{isSettingsButtonVisible:t.computed({get(){return be.value},set(n){n?Ae():he()}}),onSettingsButtonClicked:a,showSettingsButton:Ae,hideSettingsButton:he}}function Mt(e,a){Telegram.WebApp.shareToStory(e,a)}function Pt(){return{shareToStory:Mt}}const Te=t.ref(Telegram.WebApp.colorScheme),Ce=t.ref(Telegram.WebApp.themeParams),Se=t.ref(Telegram.WebApp.headerColor),ye=t.ref(Telegram.WebApp.backgroundColor);function A(){Te.value=Telegram.WebApp.colorScheme,Ce.value={...Telegram.WebApp.themeParams},Se.value=Telegram.WebApp.headerColor,ye.value=Telegram.WebApp.backgroundColor}function ke(...e){Telegram.WebApp.setHeaderColor(...e),A()}function we(...e){Telegram.WebApp.setBackgroundColor(...e),A()}function _t(){const{onEvent:e}=u(),a=(n,o)=>e("themeChanged",n,o);return a(A),{colorScheme:t.readonly(Te),themeParams:t.readonly(Ce),headerColor:t.computed({get(){return Se.value},set(n){ke(n)}}),backgroundColor:t.computed({get(){return ye.value},set(n){we(n)}}),setHeaderColor:ke,setBackgroundColor:we,onThemeChanged:a}}const Me=t.ref(Telegram.WebApp.isExpanded),Pe=t.ref(Telegram.WebApp.viewportHeight),_e=t.ref(Telegram.WebApp.viewportStableHeight),xe=t.ref(Telegram.WebApp.isVerticalSwipesEnabled);function b(){Me.value=Telegram.WebApp.isExpanded,Pe.value=Telegram.WebApp.viewportHeight,_e.value=Telegram.WebApp.viewportStableHeight,xe.value=Telegram.WebApp.isVerticalSwipesEnabled}function xt(...e){Telegram.WebApp.expand(...e),b()}const qe=(...e)=>{Telegram.WebApp.enableVerticalSwipes(...e),b()},Ee=(...e)=>{Telegram.WebApp.disableVerticalSwipes(...e),b()};function De(){const{onEvent:e}=u(),a=(n,o)=>e("viewportChanged",n,o);return a(b),{isExpanded:t.readonly(Me),viewportHeight:t.readonly(Pe),viewportStableHeight:t.readonly(_e),expand:xt,onViewportChanged:a,isVerticalSwipesEnabled:t.computed({get(){return xe.value},set(n){n?qe():Ee()}}),enableVerticalSwipes:qe,disableVerticalSwipes:Ee}}const qt={install(e){e.component("TgAlert",h),e.component("TgBackButton",W),e.component("TgBiometricManager",T),e.component("TgClosingConfirmation",C),e.component("TgConfirm",S),e.component("TgExpandedViewport",y),e.component("TgMainButton",k),e.component("TgPopup",w),e.component("TgScanQr",M),e.component("TgSettingsButton",P),e.component("TgShareWidget",_),e.component("TgPostWidget",x),e.component("TgLoginWidget",q),e.component("TgDiscussionWidget",E)}};r.Alert=h,r.BackButton=W,r.BiometricManager=T,r.ClosingConfirmation=C,r.Confirm=S,r.DiscussionWidget=E,r.ExpandedViewport=y,r.LoginWidget=q,r.MainButton=k,r.Popup=w,r.PostWidget=x,r.ScanQr=M,r.SettingsButton=P,r.ShareWidget=_,r.VueTelegramPlugin=qt,r.useWebApp=u,r.useWebAppBackButton=L,r.useWebAppBiometricManager=G,r.useWebAppClipboard=Xe,r.useWebAppClosingConfirmation=ee,r.useWebAppCloudStorage=at,r.useWebAppHapticFeedback=ct,r.useWebAppMainButton=ge,r.useWebAppNavigation=dt,r.useWebAppPopup=f,r.useWebAppQrScanner=fe,r.useWebAppRequests=Tt,r.useWebAppSendData=wt,r.useWebAppSettingsButton=We,r.useWebAppShare=Pt,r.useWebAppTheme=_t,r.useWebAppViewport=De,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
